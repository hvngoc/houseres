(function () {
  [].forEach.call(document.querySelectorAll("link[rel=preload]"), function(link) {
    if(link.as == "style"){
      link.rel = 'stylesheet'
    }else if(link.as == "script"){
      var usedLaterScript = document.createElement('script');
      usedLaterScript.src = link.href;    
      document.body.appendChild(usedLaterScript)
    }
  })
}());  

var lazyimages = document.querySelectorAll(".lazy");
lazyload(lazyimages);

function isMobile(){
  if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
    return true;
  }else{
    return false;
  }
}

jQuery(document).ready(function () {
  var responsiveWidth = 1199;
  
  var sections = $("#fullpage > section");
  var fullpage_api = $('#fullpage').fullpage({
    sectionSelector: 'section',
    //continuousVertical: true,
    scrollingSpeed: 1200,
    // navigation: true,
    // navigationPosition: 'left',
    // navigationTooltips: ['Home', 'Building Blocks', 'Achievement'],
    // showActiveTooltip: true,
    navigation: false,
    onLeave: function (index, nextIndex, destination) {
      if(index == 1 && destination == "down"){
        $("#youtube").trigger("click");
      }
      $('#fullpageNav ul li.current').removeClass("current");
      $('#fullpageNav').find('li').eq(nextIndex - 1).addClass("current");
    },
    afterLoad: function (origin, destination) {
      if (sections[destination - 1]) {
        //$(sections[destination - 1]).addClass('animated-done')
        $(".animated", sections[destination - 1]).addClass('go');
      }
    },
    afterResponsive: function(isResponsive) {
      if (isResponsive) {
        $(".animated").addClass('go');
      }
    },
    afterSlideLoad: function (anchorLink, index, slideAnchor, slideIndex) {
      // $('#fullpageNav ul li').on("click", function(e){
      //   e.preventDefault();
      //   target = $(this).find("a").data("id");
      //   console.log(target);
      //   fullpage_api.moveTo(target, 1);
      // })
    },
    scrollOverflow: true,
    responsive: responsiveWidth,
    lockAnchors: true,
    scrollOverflowOptions: {
      click: false,
      //preventDefaultException: { tagName: /.*/ },
    },
  });
 
  $('#fullpageNav ul li').on("click", function(e){
    e.preventDefault();
    target = $(this).find("a").data("id");
    $.fn.fullpage.moveTo(target);
  });  

  $("#firstLoading").click(function(){$("#firstLoading").addClass("disabled")})
  setTimeout(()=>{
    $("#firstLoading").addClass("disabled");
  }, 2900)
  setTimeout(()=>{
    $("#layer_2").addClass("show");
  }, 1500)
  $("#firstLoading").click(function(){$("#firstLoading").addClass("disabled")})
  setTimeout(()=>{
    $("#firstLoading").remove();
    $("#fullpageNav").addClass("show");
    $("#cta").addClass("show");
  }, 3500)

  $(".btn-reg").on("click", function (e) {
    e.preventDefault();
    $('#contactModal').modal('show');
  });

  $(".menu-toggle").on("click", function () {
    $("#main_menu").toggleClass("open");
    $("#header").toggleClass("active");
    $("body").toggleClass("fixed");
    $(".hom").toggleClass("hide");
    $(this).toggleClass("active");
  });

  document.addEventListener('wpcf7submit', function () {
    $.fn.fullpage.reBuild();
  }, false);

});
